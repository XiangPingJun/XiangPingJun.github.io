<html>

<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
  <script>
    function deriveKey(passphrase, salt) {
      return CryptoJS.PBKDF2(passphrase, salt, {
        keySize: 256 / 32,
        iterations: 10000
      })
    }

    function encrypt() {
      const passphrase = document.getElementById('kkey').value
      const value = document.getElementById('text').value.trim()

      const salt = CryptoJS.lib.WordArray.random(32)
      const key = deriveKey(passphrase, salt)
      const iv = CryptoJS.lib.WordArray.random(16)

      const cipher = CryptoJS.AES.encrypt(value, key, { iv: iv }).toString()
      const result =
        salt.toString(CryptoJS.enc.Base64) +
        ':' +
        iv.toString(CryptoJS.enc.Base64) +
        ':' +
        cipher

      document.getElementById('text').value = result
    }

    function decrypt() {
      try {
        const passphrase = document.getElementById('kkey').value
        const value = document.getElementById('text').value.trim()
        const parts = value.split(':')
        if (parts.length < 3) throw new Error('Invalid ciphertext')
        const salt = CryptoJS.enc.Base64.parse(parts[0])
        const iv = CryptoJS.enc.Base64.parse(parts[1])
        const ciphertext = parts.slice(2).join(':')

        let decipher = CryptoJS.AES.decrypt(ciphertext, deriveKey(passphrase, salt), { iv: iv })
        decipher = decipher.toString(CryptoJS.enc.Utf8)
        document.getElementById('text').value = decipher
      } catch (err) {
        document.getElementById('kkey').style.color = 'red'
        throw err
      }
      document.getElementById('kkey').style.color = 'black'
    }

    const pageLoadTime = Date.now()
    setInterval(() => {
      if (Date.now() > pageLoadTime + 3600000) {
        location.reload()
      }
    }, 60000)
  </script>
  <style>
    * {
      font-size: 16px !important;
    }
  </style>
</head>

<body>
  <input id="kkey" type="password" style="margin-top: 5px;" onKeydown="javascript: if (event.keyCode===13) decrypt()" />
  <button onclick="decrypt()">Dec</button>
  <button onclick="encrypt()">Enc</button>
  <div>
    <textarea id="text" style="width: 100%; height: 90vh; margin-top: 5px;">
      OOcEH37qsmOfsZ5NBohHEHMwJoV16QjHDrR+NIyAyDc=:uNaSUcUnvABGGy1Oz7maog==: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
    </textarea>
  </div>

  <script>
    document.getElementById('kkey').focus()
  </script>
</body>

</html>
