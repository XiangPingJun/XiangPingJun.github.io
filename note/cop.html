<html>

<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
  <script>
    function deriveKey(passphrase, salt) {
      return CryptoJS.PBKDF2(passphrase, salt, {
        keySize: 256 / 32,
        iterations: 10000
      })
    }

    function encrypt() {
      const passphrase = document.getElementById('kkey').value
      const value = document.getElementById('text').value.trim()

      const salt = CryptoJS.lib.WordArray.random(32)
      const key = deriveKey(passphrase, salt)
      const iv = CryptoJS.lib.WordArray.random(16)

      const cipher = CryptoJS.AES.encrypt(value, key, { iv: iv }).toString()
      const result =
        salt.toString(CryptoJS.enc.Base64) +
        ':' +
        iv.toString(CryptoJS.enc.Base64) +
        ':' +
        cipher

      document.getElementById('text').value = result
    }

    function decrypt() {
      try {
        const passphrase = document.getElementById('kkey').value
        const value = document.getElementById('text').value.trim()
        const parts = value.split(':')
        if (parts.length < 3) throw new Error('Invalid ciphertext')
        const salt = CryptoJS.enc.Base64.parse(parts[0])
        const iv = CryptoJS.enc.Base64.parse(parts[1])
        const ciphertext = parts.slice(2).join(':')

        let decipher = CryptoJS.AES.decrypt(ciphertext, deriveKey(passphrase, salt), { iv: iv })
        decipher = decipher.toString(CryptoJS.enc.Utf8)
        document.getElementById('text').value = decipher
      } catch (err) {
        document.getElementById('kkey').style.color = 'red'
        throw err
      }
      document.getElementById('kkey').style.color = 'black'
    }

    const pageLoadTime = Date.now()
    setInterval(() => {
      if (Date.now() > pageLoadTime + 3600000) {
        location.reload()
      }
    }, 60000)
  </script>
  <style>
    * {
      font-size: 16px !important;
    }
  </style>
</head>

<body>
  <input id="kkey" type="password" style="margin-top: 5px;" onKeydown="javascript: if (event.keyCode===13) decrypt()" />
  <button onclick="decrypt()">Dec</button>
  <button onclick="encrypt()">Enc</button>
  <div>
    <textarea id="text" style="width: 100%; height: 90vh; margin-top: 5px;">
      KBgzXmcRa2OjRb69hgc0Pny6DPejveHyKcGycyqGkX4=:Y8DbWm3zBaC1FjZ46RWYZw==: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
    </textarea>
  </div>

  <script>
    document.getElementById('kkey').focus()
  </script>
</body>

</html>
