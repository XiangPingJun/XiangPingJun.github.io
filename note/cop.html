<html>

<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
  <script>
    function deriveKey(passphrase, salt) {
      return CryptoJS.PBKDF2(passphrase, salt, {
        keySize: 256 / 32,
        iterations: 10000
      })
    }

    function encrypt() {
      const passphrase = document.getElementById('kkey').value
      const value = document.getElementById('text').value.trim()

      const salt = CryptoJS.lib.WordArray.random(32)
      const key = deriveKey(passphrase, salt)
      const iv = CryptoJS.lib.WordArray.random(16)

      const cipher = CryptoJS.AES.encrypt(value, key, { iv: iv }).toString()
      const result =
        salt.toString(CryptoJS.enc.Base64) +
        ':' +
        iv.toString(CryptoJS.enc.Base64) +
        ':' +
        cipher

      document.getElementById('text').value = result
    }

    function decrypt() {
      try {
        const passphrase = document.getElementById('kkey').value
        const value = document.getElementById('text').value.trim()
        const parts = value.split(':')
        if (parts.length < 3) throw new Error('Invalid ciphertext')
        const salt = CryptoJS.enc.Base64.parse(parts[0])
        const iv = CryptoJS.enc.Base64.parse(parts[1])
        const ciphertext = parts.slice(2).join(':')

        let decipher = CryptoJS.AES.decrypt(ciphertext, deriveKey(passphrase, salt), { iv: iv })
        decipher = decipher.toString(CryptoJS.enc.Utf8)
        document.getElementById('text').value = decipher
      } catch (err) {
        document.getElementById('kkey').style.color = 'red'
        throw err
      }
      document.getElementById('kkey').style.color = 'black'
    }

    const pageLoadTime = Date.now()
    setInterval(() => {
      if (Date.now() > pageLoadTime + 3600000) {
        location.reload()
      }
    }, 60000)
  </script>
  <style>
    * {
      font-size: 16px !important;
    }
  </style>
</head>

<body>
  <input id="kkey" type="password" style="margin-top: 5px;" onKeydown="javascript: if (event.keyCode===13) decrypt()" />
  <button onclick="decrypt()">Dec</button>
  <button onclick="encrypt()">Enc</button>
  <div>
    <textarea id="text" style="width: 100%; height: 90vh; margin-top: 5px;">
      erbdaJpUoQC/shDdwsGrUMqHIG9x1/EHGMRMUf7kKus=:Wq+gpuhHF9UyCw7cF8RR6w==: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
    </textarea>
  </div>

  <script>
    document.getElementById('kkey').focus()
  </script>
</body>

</html>
