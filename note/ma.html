<html>

<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
  <script>
    function deriveKey(passphrase, salt) {
      return CryptoJS.PBKDF2(passphrase, salt, {
        keySize: 256 / 32,
        iterations: 100000,
        hasher: CryptoJS.algo.SHA256 // Recommended: Explicitly use SHA256
      });
    }

    function uint8ToBase64(uint8) {
      let binary = "";
      const chunkSize = 0x8000; // ÈÅøÂÖç call stack overflow

      for (let i = 0; i < uint8.length; i += chunkSize) {
        const chunk = uint8.subarray(i, i + chunkSize);
        binary += String.fromCharCode(...chunk);
      }

      return btoa(binary);
    }

    function base64ToUint8(base64) {
      const binary = atob(base64);
      const bytes = new Uint8Array(binary.length);

      for (let i = 0; i < binary.length; i++) {
        bytes[i] = binary.charCodeAt(i);
      }

      return bytes;
    }

    async function compress(str) {
      const encoder = new TextEncoder();
      const data = encoder.encode(str);

      const cs = new CompressionStream("gzip");
      const writer = cs.writable.getWriter();
      writer.write(data);
      writer.close();

      const buffer = await new Response(cs.readable).arrayBuffer();
      return uint8ToBase64(new Uint8Array(buffer));
    }

    async function encrypt() {
      const passphrase = document.getElementById('kkey').value
      const value = await compress(document.getElementById('text').value.trim())

      const salt = CryptoJS.lib.WordArray.random(32)
      const key = deriveKey(passphrase, salt)
      const iv = CryptoJS.lib.WordArray.random(16)

      const cipher = CryptoJS.AES.encrypt(value, key, { iv: iv }).toString()
      const result =
        salt.toString(CryptoJS.enc.Base64) +
        ':' +
        iv.toString(CryptoJS.enc.Base64) +
        ':' +
        cipher

      document.getElementById('text').value = result
    }

    async function decompress(base64) {
      const uint8 = base64ToUint8(base64);

      const ds = new DecompressionStream("gzip");
      const writer = ds.writable.getWriter();
      writer.write(uint8);
      writer.close();

      const buffer = await new Response(ds.readable).arrayBuffer();
      return new TextDecoder().decode(buffer);
    }

    async function decrypt() {
      try {
        document.getElementById('kkey').disabled = true
        await new Promise((r) => setTimeout(r))
        const passphrase = document.getElementById('kkey').value
        const value = document.getElementById('text').value.trim()
        const parts = value.split(':')
        if (parts.length < 3) throw new Error('Invalid ciphertext')
        const salt = CryptoJS.enc.Base64.parse(parts[0])
        const iv = CryptoJS.enc.Base64.parse(parts[1])
        const ciphertext = parts.slice(2).join(':')

        let decipher = CryptoJS.AES.decrypt(ciphertext, deriveKey(passphrase, salt), { iv: iv })
        decipher = decipher.toString(CryptoJS.enc.Utf8)
        if (!decipher) {
          throw new Error('Decryption failed')
        }
        decipher = await decompress(decipher)
        document.getElementById('text').value = decipher
      } catch (err) {
        document.getElementById('kkey').style.color = 'red'
        throw err
      } finally {
        document.getElementById('kkey').disabled = false
      }
      document.getElementById('kkey').style.color = 'black'
    }

    function generatePassword() {
      const length = 12
      const lowercase = 'abcdefghijklmnopqrstuvwxyz'
      const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
      const digits = '0123456789'
      const allChars = lowercase + uppercase + digits

      let retVal = ''
      retVal += lowercase.charAt(Math.floor(Math.random() * lowercase.length))
      retVal += uppercase.charAt(Math.floor(Math.random() * uppercase.length))
      retVal += digits.charAt(Math.floor(Math.random() * digits.length))

      for (let i = 4, n = allChars.length; i < length; ++i) {
        retVal += allChars.charAt(Math.floor(Math.random() * n))
      }

      retVal = retVal.split('').sort(() => Math.random() - 0.5).join('') // Shuffle the password
      document.getElementById('genPw').innerText = retVal
    }

    const pageLoadTime = Date.now()
    setInterval(() => {
      if (Date.now() > pageLoadTime + 3600000) {
        location.reload()
      }
    }, 60000)

  </script>
  <style>
    * {
      font-size: 16px !important;
    }
  </style>
</head>

<body>
  <input id="kkey" type="password" style="margin-top: 5px;" onKeydown="javascript: if (event.keyCode===13) decrypt()" />
  <button onclick="decrypt()">üîë</button>
  <button onclick="encrypt()">üîí</button>
  <button onclick="generatePassword()" style="margin-left: 30px;">üé≤</button>
  <span id="genPw"></span>
  <div>
    <textarea id="text" style="width: 100%; height: 90vh; margin-top: 5px;">
      49kCPSox/IAnrYM4kKLrT9vV7YuIyFRSVTlU4IDuc7s=:zPQDyOAr/Cb3TgNG8WjX7Q==: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
    </textarea>
  </div>

  <script>
    document.getElementById('kkey').focus()
  </script>
</body>

</html>
